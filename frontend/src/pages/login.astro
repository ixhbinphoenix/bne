---
import LoginLayout from "../layouts/LoginLayout.astro";
import LoginForm from "../components/LoginForm";
import { checkSessionIdAstro } from "../api/frontmatter";
process.env.NODE_TLS_REJECT_UNAUTHORIZED = "0"; //super unsafe code here btw

const id: string | undefined = Astro.cookies.get("id").value;

if (id) {
  try {
    const result = await checkSessionIdAstro(id);
    if (result) {
      return Astro.redirect("/home");
    }
  } catch (error) {
    return Astro.redirect("/home");
  }
}
---

<LoginLayout title="Login">
  <LoginForm client:load />
</LoginLayout>
